<div style='padding: 0 1em; display: table; margin: 2em auto'>
    <button style='float: right' id='button-search'>
        Download Needed Episodes Now
    </button>
    <div style='clear: both; padding-top: 0.75em'></div>
    %include library/download-needed-episodes.tmpl root=root, buttonid='button-search', showid=''
    <table id='episode-list' class='grid align-center interactive' width='100%' style='z-index: 2; position: relative'>
    <thead id='episode-list-header'>
    <tr>
        <th style='padding: 0 0.7em'><input type='checkbox' /></th>
        <th style='text-align: left'>Series</th>
        <th style='padding: 0 0.7em'>#</th>
        <th style='text-align: left'>Episode Name</th>
        <th>Progress</th>
        <th>Speed</th>
    </tr>
    </thead>
    <tbody>
    %if not manager.retrieve_queue:
        <tr>
            <td colspan="6">
                No episodes are currently queued for download.
            </td>
        </tr>

    %end
    %for ep, results in manager.retrieve_queue:
        <tr id='{{ep.series.id}}-{{ep.code}}' class='ep' >
            <td style='padding: 0'><input type='checkbox' /></td>
            <td style='text-align: left'>{{ep.series.name}}</td>
            <td style='padding:0'>{{ep.season.number}}x{{ep.number}}</td>
            <td style='text-align: left'>{{ep.name}}</td>
        %ip = manager.get_episode_retrieve_inprogress(ep)
        %if ip:
            <td align='valign'>
                <div id="progressbar" style='height: 1.5em; width: 150px'>
                <div style='position: absolute; width: 150px; text-align: center; color:white; font-size: 11px; padding-top: 3px'>
                    {{'%.1f' % (ip.progress.pos/1024.0)}} / {{'%.1f' % (ip.progress.max/1024)}} MB
                </div>
                </div>
                <script type='text/coffeescript'>
                $( "#progressbar" ).progressbar value: `{{ip.progress.percentage}}`
                </script>
            </td>
            <td>{{int(ip.progress.speed)}} KB/s</td>
        %else:
            <td>Waiting</td>
            <td></td>
        %end
        </tr>
    %end
    </tbody>
    </table>
</div>   
%rebase layout.tmpl title='Active Downloads | Schedule', section="schedule", subsection='downloads'
